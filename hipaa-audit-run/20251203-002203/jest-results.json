{"numFailedTestSuites":2,"numFailedTests":15,"numPassedTestSuites":0,"numPassedTests":1,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":2,"numTotalTests":16,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1764739629285,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["Patient Encryption Service","encryptPatientPHI"],"duration":89,"failureDetails":[{}],"failureMessages":["Error: Failed to encrypt PHI field: first_name\n    at Object.encryptPatientPHI (/Users/mjrodriguez/Desktop/paper emr/server/services/patientEncryptionService.js:57:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (/Users/mjrodriguez/Desktop/paper emr/server/tests/patient-encryption.test.js:32:25)"],"fullName":"Patient Encryption Service encryptPatientPHI should encrypt PHI fields","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should encrypt PHI fields"},{"ancestorTitles":["Patient Encryption Service","encryptPatientPHI"],"duration":35,"failureDetails":[{}],"failureMessages":["Error: Failed to encrypt PHI field: first_name\n    at Object.encryptPatientPHI (/Users/mjrodriguez/Desktop/paper emr/server/services/patientEncryptionService.js:57:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (/Users/mjrodriguez/Desktop/paper emr/server/tests/patient-encryption.test.js:63:25)"],"fullName":"Patient Encryption Service encryptPatientPHI should handle null and undefined values","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle null and undefined values"},{"ancestorTitles":["Patient Encryption Service","decryptPatientPHI"],"duration":33,"failureDetails":[{}],"failureMessages":["Error: Failed to encrypt PHI field: first_name\n    at Object.encryptPatientPHI (/Users/mjrodriguez/Desktop/paper emr/server/services/patientEncryptionService.js:57:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (/Users/mjrodriguez/Desktop/paper emr/server/tests/patient-encryption.test.js:83:25)"],"fullName":"Patient Encryption Service decryptPatientPHI should decrypt PHI fields","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should decrypt PHI fields"},{"ancestorTitles":["Patient Encryption Service","decryptPatientPHI"],"duration":34,"failureDetails":[{}],"failureMessages":["Error: Failed to encrypt PHI field: first_name\n    at Object.encryptPatientPHI (/Users/mjrodriguez/Desktop/paper emr/server/services/patientEncryptionService.js:57:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at Object.<anonymous> (/Users/mjrodriguez/Desktop/paper emr/server/tests/patient-encryption.test.js:113:25)"],"fullName":"Patient Encryption Service decryptPatientPHI should handle roundtrip encryption/decryption","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle roundtrip encryption/decryption"},{"ancestorTitles":["Patient Encryption Service","decryptPatientsPHI"],"duration":34,"failureDetails":[{}],"failureMessages":["Error: Failed to encrypt PHI field: first_name\n    at Object.encryptPatientPHI (/Users/mjrodriguez/Desktop/paper emr/server/services/patientEncryptionService.js:57:15)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Promise.all (index 0)\n    at Object.<anonymous> (/Users/mjrodriguez/Desktop/paper emr/server/tests/patient-encryption.test.js:136:25)"],"fullName":"Patient Encryption Service decryptPatientsPHI should decrypt multiple patients","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should decrypt multiple patients"},{"ancestorTitles":["Patient Encryption Service","isPHIField"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Patient Encryption Service isPHIField should identify PHI fields correctly","invocations":1,"location":null,"numPassingAsserts":10,"retryReasons":[],"status":"passed","title":"should identify PHI fields correctly"}],"endTime":1764739629686,"message":"  ● Patient Encryption Service › encryptPatientPHI › should encrypt PHI fields\n\n    Failed to encrypt PHI field: first_name\n\n      55 |         // Don't fail the entire operation, but log the error\n      56 |         // In production, you might want to fail here\n    > 57 |         throw new Error(`Failed to encrypt PHI field: ${field}`);\n         |               ^\n      58 |       }\n      59 |     }\n      60 |   }\n\n      at Object.encryptPatientPHI (services/patientEncryptionService.js:57:15)\n      at Object.<anonymous> (tests/patient-encryption.test.js:32:25)\n\n  ● Patient Encryption Service › encryptPatientPHI › should handle null and undefined values\n\n    Failed to encrypt PHI field: first_name\n\n      55 |         // Don't fail the entire operation, but log the error\n      56 |         // In production, you might want to fail here\n    > 57 |         throw new Error(`Failed to encrypt PHI field: ${field}`);\n         |               ^\n      58 |       }\n      59 |     }\n      60 |   }\n\n      at Object.encryptPatientPHI (services/patientEncryptionService.js:57:15)\n      at Object.<anonymous> (tests/patient-encryption.test.js:63:25)\n\n  ● Patient Encryption Service › decryptPatientPHI › should decrypt PHI fields\n\n    Failed to encrypt PHI field: first_name\n\n      55 |         // Don't fail the entire operation, but log the error\n      56 |         // In production, you might want to fail here\n    > 57 |         throw new Error(`Failed to encrypt PHI field: ${field}`);\n         |               ^\n      58 |       }\n      59 |     }\n      60 |   }\n\n      at Object.encryptPatientPHI (services/patientEncryptionService.js:57:15)\n      at Object.<anonymous> (tests/patient-encryption.test.js:83:25)\n\n  ● Patient Encryption Service › decryptPatientPHI › should handle roundtrip encryption/decryption\n\n    Failed to encrypt PHI field: first_name\n\n      55 |         // Don't fail the entire operation, but log the error\n      56 |         // In production, you might want to fail here\n    > 57 |         throw new Error(`Failed to encrypt PHI field: ${field}`);\n         |               ^\n      58 |       }\n      59 |     }\n      60 |   }\n\n      at Object.encryptPatientPHI (services/patientEncryptionService.js:57:15)\n      at Object.<anonymous> (tests/patient-encryption.test.js:113:25)\n\n  ● Patient Encryption Service › decryptPatientsPHI › should decrypt multiple patients\n\n    Failed to encrypt PHI field: first_name\n\n      55 |         // Don't fail the entire operation, but log the error\n      56 |         // In production, you might want to fail here\n    > 57 |         throw new Error(`Failed to encrypt PHI field: ${field}`);\n         |               ^\n      58 |       }\n      59 |     }\n      60 |   }\n\n      at Object.encryptPatientPHI (services/patientEncryptionService.js:57:15)\n          at async Promise.all (index 0)\n      at Object.<anonymous> (tests/patient-encryption.test.js:136:25)\n","name":"/Users/mjrodriguez/Desktop/paper emr/server/tests/patient-encryption.test.js","startTime":1764739629323,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["HIPAA Compliance Integration Tests","RBAC Enforcement"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests RBAC Enforcement should return 403 when user lacks required privilege","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return 403 when user lacks required privilege"},{"ancestorTitles":["HIPAA Compliance Integration Tests","RBAC Enforcement"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests RBAC Enforcement should have requirePrivilege middleware on PHI routes","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should have requirePrivilege middleware on PHI routes"},{"ancestorTitles":["HIPAA Compliance Integration Tests","Audit Logging"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests Audit Logging should create audit log entry on patient access","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should create audit log entry on patient access"},{"ancestorTitles":["HIPAA Compliance Integration Tests","Audit Logging"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests Audit Logging should prevent audit log modification (append-only)","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should prevent audit log modification (append-only)"},{"ancestorTitles":["HIPAA Compliance Integration Tests","Audit Logging"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests Audit Logging should sanitize PHI from audit log details","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should sanitize PHI from audit log details"},{"ancestorTitles":["HIPAA Compliance Integration Tests","Encryption Service"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests Encryption Service should encrypt and decrypt field successfully","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should encrypt and decrypt field successfully"},{"ancestorTitles":["HIPAA Compliance Integration Tests","Encryption Service"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests Encryption Service should fail if KMS_PROVIDER=local in production","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail if KMS_PROVIDER=local in production"},{"ancestorTitles":["HIPAA Compliance Integration Tests","Session Management"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests Session Management should have session timeout middleware","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should have session timeout middleware"},{"ancestorTitles":["HIPAA Compliance Integration Tests","Password Policy"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests Password Policy should enforce strong password requirements","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should enforce strong password requirements"},{"ancestorTitles":["HIPAA Compliance Integration Tests","HTTPS Enforcement"],"duration":0,"failureDetails":[{}],"failureMessages":["ReferenceError: roleId is not defined\n    at Object.roleId (/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js:43:55)\n    at Promise.then.completed (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusHook (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:281:40)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:95:7)\n    at _runTestsForDescribeBlock (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/mjrodriguez/Desktop/paper emr/server/node_modules/jest-runner/build/runTest.js:444:34)"],"fullName":"HIPAA Compliance Integration Tests HTTPS Enforcement should have HTTPS enforcement middleware","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should have HTTPS enforcement middleware"}],"endTime":1764739629830,"message":"  ● HIPAA Compliance Integration Tests › RBAC Enforcement › should return 403 when user lacks required privilege\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › RBAC Enforcement › should have requirePrivilege middleware on PHI routes\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › Audit Logging › should create audit log entry on patient access\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › Audit Logging › should prevent audit log modification (append-only)\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › Audit Logging › should sanitize PHI from audit log details\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › Encryption Service › should encrypt and decrypt field successfully\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › Encryption Service › should fail if KMS_PROVIDER=local in production\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › Session Management › should have session timeout middleware\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › Password Policy › should enforce strong password requirements\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n\n  ● HIPAA Compliance Integration Tests › HTTPS Enforcement › should have HTTPS enforcement middleware\n\n    ReferenceError: roleId is not defined\n\n      41 |       VALUES ($1, $2, $3, $4, $5, 'active')\n      42 |       RETURNING id\n    > 43 |     `, ['test@example.com', 'hashed', 'Test', 'User', roleId || null]);\n         |                                                       ^\n      44 |     testUserId = userResult.rows[0].id;\n      45 |     testToken = createTestToken(testUserId);\n      46 |\n\n      at Object.roleId (tests/hipaa-integration.test.js:43:55)\n","name":"/Users/mjrodriguez/Desktop/paper emr/server/tests/hipaa-integration.test.js","startTime":1764739629693,"status":"failed","summary":""}],"wasInterrupted":false}
